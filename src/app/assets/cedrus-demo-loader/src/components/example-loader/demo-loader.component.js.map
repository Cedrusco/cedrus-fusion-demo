{"version":3,"file":"demo-loader.component.js","sourceRoot":"","sources":["demo-loader.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnDestroy, Input, ViewContainerRef,\r\n  ViewChildren, QueryList, ReflectiveInjector, ComponentFactoryResolver } from '@angular/core';\r\n\r\nimport { Subscription } from 'rxjs/Subscription';\r\n\r\nimport { ExampleLoaderService } from '../../services/index';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'cd-demo-loader',\r\n    styleUrls: ['./demo-loader.component.css'],\r\n    templateUrl: './demo-loader.component.html'\r\n})\r\nexport class DemoLoaderComponent implements OnDestroy {\r\n    getSubscription: Subscription;\r\n\r\n    data: any;\r\n    current = null;\r\n    currentName = '';\r\n    currentFilename = '';\r\n    currentSource: any = { examples: [],\r\n                    documentation: ''\r\n                  };\r\n    currentDescription = '';\r\n\r\n    currentComponent = null;\r\n    overviewComponent = null;\r\n\r\n    showHide: boolean[] = [];\r\n    initialized = false;\r\n    @ViewChildren('dynamicComponentContainer', { read: ViewContainerRef }) dynamicComponentContainer: QueryList<ViewContainerRef>;\r\n\r\n    @Input() set componentData(data: {componentName: string, description: string, fileName: string, demos:[{component: any, title:string, inputs: any }]}) {\r\n      if (!data) {\r\n        return;\r\n      }\r\n       this.data = data;\r\n\r\n      this.getSubscription = this.exampleLoaderService.getSource('component', this.data.fileName,data.demos.length)\r\n        .subscribe((source: any) => {\r\n          this.initialized = false;\r\n          this.currentDescription = this.data.description;\r\n          this.currentFilename = this.data.fileName;\r\n          this.currentName = this.data.componentName.substring(0,this.data.componentName.length-9);\r\n          this.currentSource = source;\r\n          this.showHide = [];\r\n          for(var i=0; i<source[\"examples\"].length;i++)\r\n            this.showHide.push(false);\r\n        });\r\n    }\r\n\r\n    clickPlunkerButton(ind): void {\r\n      const form = this.exampleLoaderService.constructPlunkerForm(this.currentSource[\"examples\"][ind]);\r\n      document.body.appendChild(form);\r\n      form.submit();\r\n      document.body.removeChild(form);\r\n    }\r\n\r\n    constructor(\r\n      private resolver: ComponentFactoryResolver,\r\n      private exampleLoaderService: ExampleLoaderService\r\n    ) { }\r\n\r\n    ngOnDestroy() {\r\n      this.getSubscription.unsubscribe();\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n      this.dynamicComponentContainer.changes.subscribe(changes => {\r\n        if(this.dynamicComponentContainer.toArray().length && this.initialized==false) {\r\n            console.log(\"Number: \",this.dynamicComponentContainer.toArray().length);\r\n           this.initialized = true;\r\n            if (this.currentComponent) {\r\n              this.currentComponent.destroy();\r\n            }\r\n            if (this.overviewComponent) {\r\n              this.overviewComponent.destroy();\r\n            }\r\n                  setTimeout(_ =>\r\n                    this.createComponent()\r\n                  );\r\n              }\r\n      });\r\n    }\r\n\r\n    createComponent(){\r\n\r\n        const inputProviders = Object.keys(this.data.demos[0].inputs).map((inputName) => {return {provide: inputName, useValue: this.data.demos[0].inputs[inputName]};});\r\n        const resolvedInputs = ReflectiveInjector.resolve(inputProviders);\r\n\r\n        const injector = ReflectiveInjector.fromResolvedProviders(resolvedInputs, this.dynamicComponentContainer.toArray()[0].parentInjector);\r\n\r\n        const factory = this.resolver.resolveComponentFactory(this.data.demos[0].component);\r\n\r\n        const component = factory.create(injector);\r\n\r\n        this.dynamicComponentContainer.toArray()[0].insert(component.hostView);\r\n        \r\n        this.overviewComponent = component;\r\n\r\n        for(var ind=0;ind<this.data.demos.length;ind++)\r\n        {\r\n          const inputProviders = Object.keys(this.data.demos[ind].inputs).map((inputName) => {return {provide: inputName, useValue: this.data.demos[ind].inputs[inputName]};});\r\n          const resolvedInputs = ReflectiveInjector.resolve(inputProviders);\r\n\r\n          const injector = ReflectiveInjector.fromResolvedProviders(resolvedInputs, this.dynamicComponentContainer.toArray()[ind+1].parentInjector);\r\n\r\n          const factory = this.resolver.resolveComponentFactory(this.data.demos[ind].component);\r\n\r\n          const component = factory.create(injector);\r\n\r\n          this.dynamicComponentContainer.toArray()[ind+1].insert(component.hostView);\r\n          \r\n          this.currentComponent = component;\r\n        }\r\n    }\r\n\r\n}\r\n"]}